<div class="thumbnail">
  @if(concert.images.thumbnail) {
    <img [src]="concert.images.thumbnail" alt="thumbnail"/>
  }

  <div class="thumbnailHeader">
    <div>
      @for (cat of concert.categories; track cat.slug) {
        <a routerLink="/category/{{ cat.slug }}">{{ cat.title }}</a>
      }
    </div>
  </div>

  <div class="thumbnailFooter">
    <div>
      <i class="fa-solid fa-calendar-days"></i>
      @if(concert.formattedDateStart === concert.formattedDateEnd) {
        <p>{{ concert.formattedDateStart }}</p>
      } @else {
        <p>{{ concert.formattedDateStart }}</p>
        <p>-</p>
        <p>{{ concert.formattedDateEnd }}</p>
      }
    </div>

    <!-- //TODO concert.location -->
    <h2>{{ concert.title }}</h2>
  </div>
</div>


<div class="options">
  <div [class.current]="currentSection === 'tickets'" (click)="scrollTo('tickets')">
    <i class="fa-solid fa-ticket"></i>
    <p>Tickets</p>
  </div>

  <div [class.current]="currentSection === 'location'" (click)="scrollTo('location')">
    <i class="fa-solid fa-location-dot"></i>
    <p>Location</p>
  </div>

  <div [class.current]="currentSection === 'description'" (click)="scrollTo('description')">
    <i class="fa-solid fa-message"></i>
    <p>Description</p>
  </div>
</div>


<section #tickets>
  <div class="sectionHeader">
    <h2>Tickets</h2>
  </div>

  <div class="tickets">
    <div class="map">
      @if(concert.images.map) {
        <img [src]="concert.images.map" alt="map image"/>
      } @else {
        <div class="noMap">
          <i class="fa-solid fa-map-location"></i>
          <p>No map available</p>
        </div>
      }
    </div>

    <div class="ticketTypes">
      @for (ticket of concert.tickets; track ticket._id) {
        <app-concert-details-ticket-card [concert]="concert" [currentTicket]="ticket"/>
      }

      <div class="ticketBtns">
        <button class="outline" disabled>Continue</button>
      </div>
    </div>
  </div>
</section>

<section #location>
  <div class="sectionHeader">
    <h2>Location</h2>
  </div>

  <div>
     LOCATION
  </div>
</section>


<section #description>
  <div class="sectionHeader">
    <h2>Description</h2>
  </div>

  <div class="description" [innerHTML]="concert.description"></div>
</section>


<style>
  .thumbnail {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 400px;
    border-bottom: var(--pico-border-width) solid var(--pico-secondary-border);

    .thumbnailFooter, .thumbnailHeader {
      padding: 20px
    }
    .thumbnailFooter > *, .thumbnailHeader > * {
      display: flex;
      align-items: center;
      gap: 10px
    }

    img {
      height: 100%;
      width: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      z-index: -1
    }
  }

  .options {
    position: sticky;
    top: 0;
    display: flex;
    border-bottom: var(--pico-border-width) solid var(--pico-secondary-border);
    background-color: var(--pico-background-color);

    & > div {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 20px;
      cursor: pointer;
      border-right: var(--pico-border-width) solid var(--pico-secondary-border);
    }

    & > *:hover {
      background-color: var(--pico-form-element-background-color);
    }

    .current *:not(i) {
      text-decoration: underline;
      text-decoration-color: var(--pico-primary-underline);
      text-underline-offset: 0.125em;
    }
  }


  .sectionHeader {
    padding: 20px;

    h2 {
      font-size: larger;
    }
  }
  section {
    padding-bottom: 20px;
    border-bottom: var(--pico-border-width) solid var(--pico-secondary-border);
  }

  .tickets {
    display: flex;
    max-height: 700px;

    .map {
      width: 50%;
      display: flex;
    }
    .map img {
      object-fit: contain;
    }
    .map .noMap {
      font-size: x-large;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .ticketTypes {
      width: 50%;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      overflow: auto;
    }

    .ticketBtns {
      display: flex;
    }
    .ticketBtns button {
      flex: 1;
    }
  }

  .description {
    padding: 20px;
  }


  @media (max-width: 700px) {
    .tickets {
      flex-direction: column;
      max-height: unset;
    }
    .tickets > * {
      width: 100% !important
    }
  }
</style>
